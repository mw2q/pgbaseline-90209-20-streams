BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270816317.195489
 ALGERIA                   |   1997 |  459513106.62106
 ALGERIA                   |   1996 | 465991779.973831
 ALGERIA                   |   1995 | 466553830.717649
 ALGERIA                   |   1994 | 459407781.733077
 ALGERIA                   |   1993 | 460764233.606139
 ALGERIA                   |   1992 |  463312428.41589
 ARGENTINA                 |   1998 | 272326078.465124
 ARGENTINA                 |   1997 | 469418731.603302
 ARGENTINA                 |   1996 | 467492105.502501
 ARGENTINA                 |   1995 | 471409459.132087
 ARGENTINA                 |   1994 | 462459878.616588
 ARGENTINA                 |   1993 | 466930467.624522
 ARGENTINA                 |   1992 | 465255250.857312
 BRAZIL                    |   1998 | 271859817.078702
 BRAZIL                    |   1997 |   460722153.8127
 BRAZIL                    |   1996 | 469049485.362594
 BRAZIL                    |   1995 | 470364045.621041
 BRAZIL                    |   1994 | 468816766.541734
 BRAZIL                    |   1993 | 462872521.702421
 BRAZIL                    |   1992 | 475443910.041737
 CANADA                    |   1998 | 280808164.416758
 CANADA                    |   1997 | 479193673.499675
 CANADA                    |   1996 |  472975190.84635
 CANADA                    |   1995 | 480806079.844924
 CANADA                    |   1994 | 487233913.864701
 CANADA                    |   1993 | 476566065.542803
 CANADA                    |   1992 | 472406081.493945
 CHINA                     |   1998 | 270900842.756921
 CHINA                     |   1997 | 455084542.080329
 CHINA                     |   1996 | 471614680.088282
 CHINA                     |   1995 | 469307476.541696
 CHINA                     |   1994 | 465043742.983585
 CHINA                     |   1993 | 467047690.367685
 CHINA                     |   1992 | 471474782.771017
 EGYPT                     |   1998 | 271337368.794713
 EGYPT                     |   1997 | 469789908.304872
 EGYPT                     |   1996 | 472468631.150426
 EGYPT                     |   1995 | 463547110.797229
 EGYPT                     |   1994 | 456809898.179444
 EGYPT                     |   1993 | 466715294.423212
 EGYPT                     |   1992 | 468361754.458524
 ETHIOPIA                  |   1998 | 264565059.828537
 ETHIOPIA                  |   1997 | 454344179.356041
 ETHIOPIA                  |   1996 | 449449229.542326
 ETHIOPIA                  |   1995 | 454254691.399598
 ETHIOPIA                  |   1994 | 455461342.353518
 ETHIOPIA                  |   1993 | 457260923.924482
 ETHIOPIA                  |   1992 | 458037631.516177
 FRANCE                    |   1998 | 274186581.823112
 FRANCE                    |   1997 | 463680619.009804
 FRANCE                    |   1996 | 465503058.169541
 FRANCE                    |   1995 | 458101753.858687
 FRANCE                    |   1994 | 459760397.893755
 FRANCE                    |   1993 | 461293816.091322
 FRANCE                    |   1992 | 460167731.254912
 GERMANY                   |   1998 | 279423374.324323
 GERMANY                   |   1997 | 477152845.423701
 GERMANY                   |   1996 | 475969226.775623
 GERMANY                   |   1995 | 464293852.551194
 GERMANY                   |   1994 | 481737467.664877
 GERMANY                   |   1993 | 473982828.046512
 GERMANY                   |   1992 | 479473081.916408
 INDIA                     |   1998 | 276175043.242816
 INDIA                     |   1997 | 464695182.212133
 INDIA                     |   1996 | 470712389.377871
 INDIA                     |   1995 | 475818510.368369
 INDIA                     |   1994 | 468923020.104302
 INDIA                     |   1993 | 468612965.246314
 INDIA                     |   1992 |  476545770.79671
 INDONESIA                 |   1998 | 275724268.311856
 INDONESIA                 |   1997 | 460870250.006992
 INDONESIA                 |   1996 | 465676297.516372
 INDONESIA                 |   1995 |  468301670.22044
 INDONESIA                 |   1994 |  464406214.84009
 INDONESIA                 |   1993 |  467668485.51168
 INDONESIA                 |   1992 | 457884014.615807
 IRAN                      |   1998 | 271673989.703766
 IRAN                      |   1997 | 464716235.553482
 IRAN                      |   1996 | 470654225.499981
 IRAN                      |   1995 | 470217658.560232
 IRAN                      |   1994 | 467140593.798861
 IRAN                      |   1993 | 463424278.333193
 IRAN                      |   1992 | 464414395.435348
 IRAQ                      |   1998 | 275631383.106407
 IRAQ                      |   1997 | 471604649.029133
 IRAQ                      |   1996 | 477261163.116705
 IRAQ                      |   1995 | 471112335.805013
 IRAQ                      |   1994 | 474744989.846263
 IRAQ                      |   1993 | 475720100.428716
 IRAQ                      |   1992 |  474592445.84094
 JAPAN                     |   1998 | 273899028.141575
 JAPAN                     |   1997 | 463936928.659689
 JAPAN                     |   1996 | 463074340.875293
 JAPAN                     |   1995 | 457533642.757058
 JAPAN                     |   1994 |  452155813.93353
 JAPAN                     |   1993 | 462296284.611818
 JAPAN                     |   1992 | 462574505.366598
 JORDAN                    |   1998 | 272769546.389841
 JORDAN                    |   1997 | 468929820.474767
 JORDAN                    |   1996 |  460174904.60765
 JORDAN                    |   1995 | 453865198.511526
 JORDAN                    |   1994 | 461919935.916542
 JORDAN                    |   1993 |  465141506.44176
 JORDAN                    |   1992 | 462906282.240852
 KENYA                     |   1998 | 271126231.814213
 KENYA                     |   1997 | 466704683.240213
 KENYA                     |   1996 | 472187728.792131
 KENYA                     |   1995 | 471148219.363431
 KENYA                     |   1994 | 472605952.969418
 KENYA                     |   1993 | 468871057.352692
 KENYA                     |   1992 |   474444973.9181
 MOROCCO                   |   1998 | 266274478.490982
 MOROCCO                   |   1997 |  469085496.49773
 MOROCCO                   |   1996 | 466877548.641805
 MOROCCO                   |   1995 | 462219012.106379
 MOROCCO                   |   1994 | 460262591.072314
 MOROCCO                   |   1993 | 465600279.042625
 MOROCCO                   |   1992 | 464630321.163531
 MOZAMBIQUE                |   1998 | 271050752.620807
 MOZAMBIQUE                |   1997 |  453993696.09918
 MOZAMBIQUE                |   1996 |  454383692.93926
 MOZAMBIQUE                |   1995 | 458324933.887518
 MOZAMBIQUE                |   1994 |  461998149.81319
 MOZAMBIQUE                |   1993 | 458922831.888126
 MOZAMBIQUE                |   1992 | 461335099.333142
 PERU                      |   1998 | 269273806.083697
 PERU                      |   1997 | 469408868.957709
 PERU                      |   1996 | 471620191.824086
 PERU                      |   1995 | 466941443.788602
 PERU                      |   1994 |  459631563.81046
 PERU                      |   1993 | 470547623.731421
 PERU                      |   1992 | 461436658.154596
 ROMANIA                   |   1998 |  275778474.96193
 ROMANIA                   |   1997 | 464827115.791962
 ROMANIA                   |   1996 | 471257212.243285
 ROMANIA                   |   1995 | 467979035.537542
 ROMANIA                   |   1994 | 465413585.464239
 ROMANIA                   |   1993 | 473167559.675666
 ROMANIA                   |   1992 | 471657387.124766
 RUSSIA                    |   1998 | 270843173.616922
 RUSSIA                    |   1997 | 465200539.368844
 RUSSIA                    |   1996 |  475146407.66316
 RUSSIA                    |   1995 | 466836660.845537
 RUSSIA                    |   1994 | 463280476.699869
 RUSSIA                    |   1993 | 469288223.389277
 RUSSIA                    |   1992 | 464649581.516302
 SAUDI ARABIA              |   1998 | 278642494.898665
 SAUDI ARABIA              |   1997 | 475293773.295931
 SAUDI ARABIA              |   1996 | 463198245.922205
 SAUDI ARABIA              |   1995 | 468746184.874039
 SAUDI ARABIA              |   1994 | 471128083.189182
 SAUDI ARABIA              |   1993 | 460986565.615481
 SAUDI ARABIA              |   1992 | 467373391.878037
 UNITED KINGDOM            |   1998 | 263814927.038742
 UNITED KINGDOM            |   1997 | 450099308.998666
 UNITED KINGDOM            |   1996 | 453798457.011336
 UNITED KINGDOM            |   1995 | 459131768.534216
 UNITED KINGDOM            |   1994 | 464476578.130876
 UNITED KINGDOM            |   1993 | 451652695.674841
 UNITED KINGDOM            |   1992 | 453621658.452155
 UNITED STATES             |   1998 |  266076993.00939
 UNITED STATES             |   1997 | 466766604.418113
 UNITED STATES             |   1996 | 462924117.965065
 UNITED STATES             |   1995 | 462964734.037435
 UNITED STATES             |   1994 | 463922653.055441
 UNITED STATES             |   1993 | 460564570.821344
 UNITED STATES             |   1992 | 461091214.765017
 VIETNAM                   |   1998 | 272304681.866302
 VIETNAM                   |   1997 | 462464949.862943
 VIETNAM                   |   1996 | 466264505.925667
 VIETNAM                   |   1995 | 467842423.291016
 VIETNAM                   |   1994 |  475969807.39448
 VIETNAM                   |   1993 | 466509129.128925
 VIETNAM                   |   1992 | 461621030.352632
(175 rows)

COMMIT;
COMMIT
