BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%cornflower%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 263784559.524146
 ALGERIA                   |   1997 |  455791206.71349
 ALGERIA                   |   1996 | 462243677.244775
 ALGERIA                   |   1995 | 464448095.078654
 ALGERIA                   |   1994 | 452599228.659814
 ALGERIA                   |   1993 | 454982855.035821
 ALGERIA                   |   1992 | 466317530.213384
 ARGENTINA                 |   1998 | 275543956.457258
 ARGENTINA                 |   1997 | 461715461.068288
 ARGENTINA                 |   1996 | 465926834.348588
 ARGENTINA                 |   1995 | 469848255.706858
 ARGENTINA                 |   1994 | 467022796.468607
 ARGENTINA                 |   1993 | 461131446.611831
 ARGENTINA                 |   1992 | 459914889.364696
 BRAZIL                    |   1998 | 280083003.791702
 BRAZIL                    |   1997 | 475041820.489838
 BRAZIL                    |   1996 | 467199418.123473
 BRAZIL                    |   1995 |  466552094.02164
 BRAZIL                    |   1994 | 471244142.850133
 BRAZIL                    |   1993 | 465757799.565771
 BRAZIL                    |   1992 | 468831362.174364
 CANADA                    |   1998 | 280674416.100345
 CANADA                    |   1997 | 473976805.797017
 CANADA                    |   1996 | 477314120.765717
 CANADA                    |   1995 | 472726124.244887
 CANADA                    |   1994 | 490482211.997362
 CANADA                    |   1993 | 484241489.413262
 CANADA                    |   1992 | 480528265.386261
 CHINA                     |   1998 | 273980254.372676
 CHINA                     |   1997 | 468587679.505077
 CHINA                     |   1996 | 473335873.630547
 CHINA                     |   1995 | 469595853.569441
 CHINA                     |   1994 | 462041260.567382
 CHINA                     |   1993 | 464692636.855586
 CHINA                     |   1992 | 466336409.486868
 EGYPT                     |   1998 | 275252525.183573
 EGYPT                     |   1997 | 465374290.666954
 EGYPT                     |   1996 | 475992639.776852
 EGYPT                     |   1995 | 468974628.134404
 EGYPT                     |   1994 | 467630518.002941
 EGYPT                     |   1993 | 472101668.764241
 EGYPT                     |   1992 | 465344052.213611
 ETHIOPIA                  |   1998 | 265433805.743226
 ETHIOPIA                  |   1997 | 452715085.903216
 ETHIOPIA                  |   1996 | 455123418.708901
 ETHIOPIA                  |   1995 | 458732929.743732
 ETHIOPIA                  |   1994 | 456511456.661383
 ETHIOPIA                  |   1993 | 454935732.327038
 ETHIOPIA                  |   1992 | 461608798.807786
 FRANCE                    |   1998 | 270807241.086546
 FRANCE                    |   1997 | 455107560.881255
 FRANCE                    |   1996 | 470560761.383701
 FRANCE                    |   1995 | 456677499.487109
 FRANCE                    |   1994 | 460975976.360479
 FRANCE                    |   1993 | 468086001.463167
 FRANCE                    |   1992 |  461608368.61177
 GERMANY                   |   1998 | 284560597.607251
 GERMANY                   |   1997 | 484409094.731335
 GERMANY                   |   1996 | 485963162.397117
 GERMANY                   |   1995 | 488078924.427484
 GERMANY                   |   1994 | 491118513.963597
 GERMANY                   |   1993 | 482858247.803105
 GERMANY                   |   1992 | 484813399.041255
 INDIA                     |   1998 | 274554410.910037
 INDIA                     |   1997 | 475042476.448807
 INDIA                     |   1996 | 473859572.784861
 INDIA                     |   1995 | 469703438.650004
 INDIA                     |   1994 | 472611026.559703
 INDIA                     |   1993 | 464543600.334082
 INDIA                     |   1992 | 474023149.393425
 INDONESIA                 |   1998 | 269429830.248442
 INDONESIA                 |   1997 | 460375747.145947
 INDONESIA                 |   1996 | 466178523.600658
 INDONESIA                 |   1995 |  461073343.52802
 INDONESIA                 |   1994 | 455902104.432616
 INDONESIA                 |   1993 | 462573276.529171
 INDONESIA                 |   1992 | 457800269.055327
 IRAN                      |   1998 | 279604354.053228
 IRAN                      |   1997 | 467528320.456469
 IRAN                      |   1996 | 468936701.791598
 IRAN                      |   1995 | 474257742.576458
 IRAN                      |   1994 | 473037800.737809
 IRAN                      |   1993 | 462815451.282073
 IRAN                      |   1992 | 470416163.328913
 IRAQ                      |   1998 | 277216619.269395
 IRAQ                      |   1997 | 464241052.646554
 IRAQ                      |   1996 |  471450125.05753
 IRAQ                      |   1995 | 462707317.812921
 IRAQ                      |   1994 | 465691491.954977
 IRAQ                      |   1993 | 467617624.895607
 IRAQ                      |   1992 | 466767973.679402
 JAPAN                     |   1998 |  274226166.23439
 JAPAN                     |   1997 | 472552315.130088
 JAPAN                     |   1996 | 461029126.323636
 JAPAN                     |   1995 |  459779507.46709
 JAPAN                     |   1994 | 468770905.929982
 JAPAN                     |   1993 | 467162684.507036
 JAPAN                     |   1992 | 471847897.215436
 JORDAN                    |   1998 |    272590743.648
 JORDAN                    |   1997 | 468994626.037969
 JORDAN                    |   1996 | 467686035.469629
 JORDAN                    |   1995 | 464357246.575093
 JORDAN                    |   1994 | 468323027.553036
 JORDAN                    |   1993 | 468087567.046166
 JORDAN                    |   1992 |  467038147.90872
 KENYA                     |   1998 | 278028776.309987
 KENYA                     |   1997 | 470182493.969059
 KENYA                     |   1996 | 473056532.777744
 KENYA                     |   1995 | 467225442.055785
 KENYA                     |   1994 | 473813293.448962
 KENYA                     |   1993 | 458527885.807792
 KENYA                     |   1992 | 465782071.715445
 MOROCCO                   |   1998 | 279665845.090192
 MOROCCO                   |   1997 | 473434210.044255
 MOROCCO                   |   1996 | 470762758.415345
 MOROCCO                   |   1995 | 468524874.802091
 MOROCCO                   |   1994 | 468639847.257837
 MOROCCO                   |   1993 | 462637534.613789
 MOROCCO                   |   1992 | 470743559.901999
 MOZAMBIQUE                |   1998 | 272560410.415119
 MOZAMBIQUE                |   1997 | 465665598.687913
 MOZAMBIQUE                |   1996 | 466390056.146897
 MOZAMBIQUE                |   1995 | 470099063.873728
 MOZAMBIQUE                |   1994 | 458134988.140786
 MOZAMBIQUE                |   1993 | 466660219.281158
 MOZAMBIQUE                |   1992 | 460403676.798432
 PERU                      |   1998 | 266684905.487865
 PERU                      |   1997 | 457153069.273589
 PERU                      |   1996 | 457343452.165455
 PERU                      |   1995 | 454851010.643947
 PERU                      |   1994 | 463046860.266447
 PERU                      |   1993 | 464541795.716783
 PERU                      |   1992 | 458420969.422701
 ROMANIA                   |   1998 | 272713049.090911
 ROMANIA                   |   1997 | 464861446.953266
 ROMANIA                   |   1996 | 473621650.337603
 ROMANIA                   |   1995 | 466772128.841838
 ROMANIA                   |   1994 | 466688210.985523
 ROMANIA                   |   1993 | 467313913.501354
 ROMANIA                   |   1992 | 464749227.588495
 RUSSIA                    |   1998 | 272637409.215788
 RUSSIA                    |   1997 | 468984583.307752
 RUSSIA                    |   1996 | 466917072.390636
 RUSSIA                    |   1995 | 469526989.164153
 RUSSIA                    |   1994 |  468331963.97633
 RUSSIA                    |   1993 | 470824010.936514
 RUSSIA                    |   1992 | 465819958.131373
 SAUDI ARABIA              |   1998 | 275069959.957804
 SAUDI ARABIA              |   1997 | 468217598.016704
 SAUDI ARABIA              |   1996 | 466037592.905803
 SAUDI ARABIA              |   1995 | 471789796.280512
 SAUDI ARABIA              |   1994 | 465807279.348029
 SAUDI ARABIA              |   1993 | 473886127.802783
 SAUDI ARABIA              |   1992 | 467713582.356624
 UNITED KINGDOM            |   1998 | 269341594.952804
 UNITED KINGDOM            |   1997 | 453478797.380136
 UNITED KINGDOM            |   1996 | 461026954.050419
 UNITED KINGDOM            |   1995 | 454233893.292057
 UNITED KINGDOM            |   1994 | 450308456.645722
 UNITED KINGDOM            |   1993 | 452176916.919831
 UNITED KINGDOM            |   1992 | 463524791.385852
 UNITED STATES             |   1998 | 275488601.752382
 UNITED STATES             |   1997 | 480381798.724407
 UNITED STATES             |   1996 | 470330239.650866
 UNITED STATES             |   1995 |  474527696.30146
 UNITED STATES             |   1994 | 475772487.766945
 UNITED STATES             |   1993 | 483325752.647875
 UNITED STATES             |   1992 | 474143415.386716
 VIETNAM                   |   1998 | 269430489.772119
 VIETNAM                   |   1997 |  463352845.75934
 VIETNAM                   |   1996 |  468708847.43124
 VIETNAM                   |   1995 | 472310377.722482
 VIETNAM                   |   1994 | 466838053.667907
 VIETNAM                   |   1993 | 465323024.767229
 VIETNAM                   |   1992 |  464955368.59427
(175 rows)

COMMIT;
COMMIT
