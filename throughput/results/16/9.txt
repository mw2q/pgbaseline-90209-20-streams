BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%bisque%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 269291469.783251
 ALGERIA                   |   1997 | 463344959.432038
 ALGERIA                   |   1996 | 463860769.540421
 ALGERIA                   |   1995 | 463643686.439917
 ALGERIA                   |   1994 | 461987381.333731
 ALGERIA                   |   1993 | 462822759.728256
 ALGERIA                   |   1992 | 454703161.521808
 ARGENTINA                 |   1998 | 270868898.680462
 ARGENTINA                 |   1997 | 466628021.437245
 ARGENTINA                 |   1996 | 468554939.691485
 ARGENTINA                 |   1995 | 460385941.545625
 ARGENTINA                 |   1994 | 464959411.792765
 ARGENTINA                 |   1993 | 462664389.656032
 ARGENTINA                 |   1992 | 462599591.851077
 BRAZIL                    |   1998 | 276894443.178586
 BRAZIL                    |   1997 | 473497652.500196
 BRAZIL                    |   1996 | 477688424.205362
 BRAZIL                    |   1995 | 468686140.988941
 BRAZIL                    |   1994 | 476542609.943966
 BRAZIL                    |   1993 | 467978919.613947
 BRAZIL                    |   1992 | 476397293.008218
 CANADA                    |   1998 | 282750719.523635
 CANADA                    |   1997 | 481101329.215905
 CANADA                    |   1996 | 482646109.755966
 CANADA                    |   1995 | 478718061.182018
 CANADA                    |   1994 | 486301573.609041
 CANADA                    |   1993 | 471991364.085314
 CANADA                    |   1992 | 481226507.101653
 CHINA                     |   1998 | 273444303.002309
 CHINA                     |   1997 | 474635282.550603
 CHINA                     |   1996 | 470900033.304392
 CHINA                     |   1995 |  473263327.56514
 CHINA                     |   1994 | 469291491.022625
 CHINA                     |   1993 | 479993611.510991
 CHINA                     |   1992 |  475347742.16806
 EGYPT                     |   1998 | 279359755.905967
 EGYPT                     |   1997 | 470520718.279904
 EGYPT                     |   1996 | 474163728.009284
 EGYPT                     |   1995 | 468895358.069253
 EGYPT                     |   1994 |  479208569.93927
 EGYPT                     |   1993 | 469871783.180494
 EGYPT                     |   1992 | 473496181.850613
 ETHIOPIA                  |   1998 |  272990792.00539
 ETHIOPIA                  |   1997 | 464153339.772424
 ETHIOPIA                  |   1996 |  464844542.73843
 ETHIOPIA                  |   1995 | 454992171.259558
 ETHIOPIA                  |   1994 | 458727593.218131
 ETHIOPIA                  |   1993 | 461159923.239378
 ETHIOPIA                  |   1992 | 468009164.720348
 FRANCE                    |   1998 | 275415156.269419
 FRANCE                    |   1997 | 456611780.527511
 FRANCE                    |   1996 |  467248663.60659
 FRANCE                    |   1995 | 459445016.278389
 FRANCE                    |   1994 | 461510897.162716
 FRANCE                    |   1993 |  465615388.79305
 FRANCE                    |   1992 | 457763552.196771
 GERMANY                   |   1998 | 271648038.983534
 GERMANY                   |   1997 |  464183548.63599
 GERMANY                   |   1996 | 456944482.368397
 GERMANY                   |   1995 | 471336992.471032
 GERMANY                   |   1994 | 472722816.533587
 GERMANY                   |   1993 | 466444721.392554
 GERMANY                   |   1992 | 471182511.826025
 INDIA                     |   1998 | 275578331.147912
 INDIA                     |   1997 | 478692389.848495
 INDIA                     |   1996 |  476669148.33246
 INDIA                     |   1995 | 474000079.149897
 INDIA                     |   1994 | 480061919.809987
 INDIA                     |   1993 | 470146583.283048
 INDIA                     |   1992 | 475049773.375732
 INDONESIA                 |   1998 | 271574488.653511
 INDONESIA                 |   1997 |  466541353.01022
 INDONESIA                 |   1996 | 469456258.336048
 INDONESIA                 |   1995 | 464764842.781076
 INDONESIA                 |   1994 | 463304917.654475
 INDONESIA                 |   1993 |    466646143.767
 INDONESIA                 |   1992 | 467110566.484451
 IRAN                      |   1998 | 271427169.772062
 IRAN                      |   1997 |  470307941.48615
 IRAN                      |   1996 |  467361200.39155
 IRAN                      |   1995 | 474581075.979196
 IRAN                      |   1994 | 467149957.843445
 IRAN                      |   1993 | 470389919.694072
 IRAN                      |   1992 | 473122729.044249
 IRAQ                      |   1998 | 278445430.321364
 IRAQ                      |   1997 | 475950374.364956
 IRAQ                      |   1996 | 472570751.153459
 IRAQ                      |   1995 | 473827111.530774
 IRAQ                      |   1994 | 478970009.522877
 IRAQ                      |   1993 | 474583047.056141
 IRAQ                      |   1992 | 482641666.215205
 JAPAN                     |   1998 | 269532881.591606
 JAPAN                     |   1997 | 464128220.678789
 JAPAN                     |   1996 | 473372592.558263
 JAPAN                     |   1995 |  460661123.70709
 JAPAN                     |   1994 | 462081826.395547
 JAPAN                     |   1993 | 466939308.156674
 JAPAN                     |   1992 | 462920816.028182
 JORDAN                    |   1998 | 279436166.679477
 JORDAN                    |   1997 | 464920606.519503
 JORDAN                    |   1996 | 465920026.992752
 JORDAN                    |   1995 | 457518633.648765
 JORDAN                    |   1994 | 464562163.380348
 JORDAN                    |   1993 |  464894350.00835
 JORDAN                    |   1992 | 459654067.758965
 KENYA                     |   1998 | 278286507.506171
 KENYA                     |   1997 | 473928000.047142
 KENYA                     |   1996 | 482293272.297998
 KENYA                     |   1995 | 485246720.146204
 KENYA                     |   1994 | 479646212.730827
 KENYA                     |   1993 | 475832400.218078
 KENYA                     |   1992 |  480130160.63843
 MOROCCO                   |   1998 | 277078746.281287
 MOROCCO                   |   1997 | 465636787.426017
 MOROCCO                   |   1996 | 467583960.453298
 MOROCCO                   |   1995 | 471332356.588219
 MOROCCO                   |   1994 | 467479634.217118
 MOROCCO                   |   1993 | 473139446.111839
 MOROCCO                   |   1992 | 474625530.562279
 MOZAMBIQUE                |   1998 | 269325128.098737
 MOZAMBIQUE                |   1997 | 456791766.811708
 MOZAMBIQUE                |   1996 | 457687314.429206
 MOZAMBIQUE                |   1995 |  460364227.17163
 MOZAMBIQUE                |   1994 | 461398187.168078
 MOZAMBIQUE                |   1993 | 449052134.269057
 MOZAMBIQUE                |   1992 | 452688080.985924
 PERU                      |   1998 | 273553124.851351
 PERU                      |   1997 | 474406414.039396
 PERU                      |   1996 | 479211810.597494
 PERU                      |   1995 | 476841398.466046
 PERU                      |   1994 | 468163854.553589
 PERU                      |   1993 | 469326251.952285
 PERU                      |   1992 | 471067214.640107
 ROMANIA                   |   1998 | 283282731.036695
 ROMANIA                   |   1997 | 479981300.377593
 ROMANIA                   |   1996 | 476733034.772761
 ROMANIA                   |   1995 | 478363403.198543
 ROMANIA                   |   1994 | 473883700.333934
 ROMANIA                   |   1993 |  481591999.06612
 ROMANIA                   |   1992 | 474701620.513189
 RUSSIA                    |   1998 | 279368277.925927
 RUSSIA                    |   1997 | 481921110.449132
 RUSSIA                    |   1996 | 470965652.844423
 RUSSIA                    |   1995 | 473079556.209033
 RUSSIA                    |   1994 | 469131932.611478
 RUSSIA                    |   1993 | 470692428.993285
 RUSSIA                    |   1992 | 475241490.181057
 SAUDI ARABIA              |   1998 | 279008545.804352
 SAUDI ARABIA              |   1997 | 474103630.246655
 SAUDI ARABIA              |   1996 | 474213573.885498
 SAUDI ARABIA              |   1995 | 477173852.127187
 SAUDI ARABIA              |   1994 | 473510505.587594
 SAUDI ARABIA              |   1993 | 474412460.625476
 SAUDI ARABIA              |   1992 |   483279921.7842
 UNITED KINGDOM            |   1998 | 275891539.564399
 UNITED KINGDOM            |   1997 | 466823030.116779
 UNITED KINGDOM            |   1996 |  467402810.86201
 UNITED KINGDOM            |   1995 | 465574590.494855
 UNITED KINGDOM            |   1994 | 472047530.182513
 UNITED KINGDOM            |   1993 | 468577075.481931
 UNITED KINGDOM            |   1992 | 469636160.726487
 UNITED STATES             |   1998 | 271914031.360565
 UNITED STATES             |   1997 | 477813084.904435
 UNITED STATES             |   1996 |  480615804.56594
 UNITED STATES             |   1995 | 482188673.961576
 UNITED STATES             |   1994 | 474724745.435697
 UNITED STATES             |   1993 | 479160100.383429
 UNITED STATES             |   1992 |  478008213.00495
 VIETNAM                   |   1998 | 267415819.265979
 VIETNAM                   |   1997 | 464946294.176786
 VIETNAM                   |   1996 | 472970874.445956
 VIETNAM                   |   1995 | 461820586.885098
 VIETNAM                   |   1994 | 474180190.293495
 VIETNAM                   |   1993 | 468411296.206267
 VIETNAM                   |   1992 | 474047545.660207
(175 rows)

COMMIT;
COMMIT
