BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%honeydew%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 272727996.129701
 ALGERIA                   |   1997 | 458644940.315902
 ALGERIA                   |   1996 | 455516347.538629
 ALGERIA                   |   1995 | 463756916.268595
 ALGERIA                   |   1994 | 455766595.011262
 ALGERIA                   |   1993 | 465661716.010656
 ALGERIA                   |   1992 | 456311965.479207
 ARGENTINA                 |   1998 | 281632830.622582
 ARGENTINA                 |   1997 | 477133140.459041
 ARGENTINA                 |   1996 | 473915228.225099
 ARGENTINA                 |   1995 | 478948246.553865
 ARGENTINA                 |   1994 | 479086790.917083
 ARGENTINA                 |   1993 | 477656178.430615
 ARGENTINA                 |   1992 | 479731488.342906
 BRAZIL                    |   1998 |  274704106.23142
 BRAZIL                    |   1997 | 474795857.234834
 BRAZIL                    |   1996 | 472722273.288647
 BRAZIL                    |   1995 |  470630343.95461
 BRAZIL                    |   1994 | 480091100.083495
 BRAZIL                    |   1993 |  465613269.96997
 BRAZIL                    |   1992 | 474357266.149331
 CANADA                    |   1998 | 281210276.806548
 CANADA                    |   1997 | 476869324.453939
 CANADA                    |   1996 | 469374211.515284
 CANADA                    |   1995 | 474923886.204914
 CANADA                    |   1994 | 480012067.155013
 CANADA                    |   1993 | 470062217.417254
 CANADA                    |   1992 | 471727660.937073
 CHINA                     |   1998 | 274174994.688638
 CHINA                     |   1997 | 466803214.614086
 CHINA                     |   1996 | 475901880.236748
 CHINA                     |   1995 | 469875913.692646
 CHINA                     |   1994 |  475503413.17757
 CHINA                     |   1993 | 467875299.042252
 CHINA                     |   1992 | 478325181.142762
 EGYPT                     |   1998 | 271846047.610879
 EGYPT                     |   1997 | 471056121.318317
 EGYPT                     |   1996 | 473307359.818744
 EGYPT                     |   1995 | 460022472.055072
 EGYPT                     |   1994 | 461772716.688398
 EGYPT                     |   1993 | 466315304.835835
 EGYPT                     |   1992 | 464484703.135614
 ETHIOPIA                  |   1998 | 276006465.408287
 ETHIOPIA                  |   1997 | 464325636.333231
 ETHIOPIA                  |   1996 | 464279239.925509
 ETHIOPIA                  |   1995 | 469833324.517014
 ETHIOPIA                  |   1994 | 469097889.476373
 ETHIOPIA                  |   1993 | 467948273.183044
 ETHIOPIA                  |   1992 | 467039107.035727
 FRANCE                    |   1998 | 264782127.863556
 FRANCE                    |   1997 | 454826325.670173
 FRANCE                    |   1996 |  456903876.93905
 FRANCE                    |   1995 | 454208733.801192
 FRANCE                    |   1994 | 451634324.675033
 FRANCE                    |   1993 | 453187437.310552
 FRANCE                    |   1992 | 456441661.770727
 GERMANY                   |   1998 | 282532990.088462
 GERMANY                   |   1997 | 477958158.762212
 GERMANY                   |   1996 | 477039414.599257
 GERMANY                   |   1995 | 485992928.045162
 GERMANY                   |   1994 | 477505696.335411
 GERMANY                   |   1993 | 475059043.377246
 GERMANY                   |   1992 | 480372329.250687
 INDIA                     |   1998 | 276600426.354216
 INDIA                     |   1997 | 471895937.974159
 INDIA                     |   1996 | 474671287.708413
 INDIA                     |   1995 | 476483879.415146
 INDIA                     |   1994 | 471634689.794173
 INDIA                     |   1993 | 468619859.516412
 INDIA                     |   1992 | 474236977.691186
 INDONESIA                 |   1998 | 272146023.855357
 INDONESIA                 |   1997 | 464884315.620532
 INDONESIA                 |   1996 | 465268688.504613
 INDONESIA                 |   1995 | 455838153.787832
 INDONESIA                 |   1994 |   465917634.3984
 INDONESIA                 |   1993 | 462119634.784528
 INDONESIA                 |   1992 | 463809639.030258
 IRAN                      |   1998 | 274219612.066349
 IRAN                      |   1997 | 470085779.234832
 IRAN                      |   1996 | 465770722.318557
 IRAN                      |   1995 | 462107919.611066
 IRAN                      |   1994 | 460762593.744466
 IRAN                      |   1993 | 469152872.398899
 IRAN                      |   1992 | 466284955.447166
 IRAQ                      |   1998 |  274720334.10379
 IRAQ                      |   1997 | 466170613.612671
 IRAQ                      |   1996 | 469684870.363116
 IRAQ                      |   1995 | 468679037.758241
 IRAQ                      |   1994 | 463636326.267444
 IRAQ                      |   1993 |  471621861.86563
 IRAQ                      |   1992 | 470199630.049112
 JAPAN                     |   1998 | 272018619.087384
 JAPAN                     |   1997 | 473219078.242266
 JAPAN                     |   1996 | 455893583.591221
 JAPAN                     |   1995 | 463740730.028203
 JAPAN                     |   1994 | 470882521.623813
 JAPAN                     |   1993 | 465003619.138296
 JAPAN                     |   1992 | 466465707.283727
 JORDAN                    |   1998 | 272282957.613958
 JORDAN                    |   1997 |  460883341.24785
 JORDAN                    |   1996 | 457746696.349105
 JORDAN                    |   1995 | 466697436.727963
 JORDAN                    |   1994 | 464617039.575095
 JORDAN                    |   1993 | 474222464.344035
 JORDAN                    |   1992 | 457357023.178051
 KENYA                     |   1998 | 276356907.188941
 KENYA                     |   1997 | 470728932.401542
 KENYA                     |   1996 | 470206820.778778
 KENYA                     |   1995 | 467223142.787733
 KENYA                     |   1994 | 468425284.460364
 KENYA                     |   1993 | 469068609.386845
 KENYA                     |   1992 | 470389065.165751
 MOROCCO                   |   1998 |  274026161.87204
 MOROCCO                   |   1997 | 469389779.371177
 MOROCCO                   |   1996 |  471149077.69123
 MOROCCO                   |   1995 | 473236306.346743
 MOROCCO                   |   1994 | 472686645.124366
 MOROCCO                   |   1993 | 473871674.407902
 MOROCCO                   |   1992 | 473137811.003426
 MOZAMBIQUE                |   1998 | 270481779.225198
 MOZAMBIQUE                |   1997 | 457380314.900651
 MOZAMBIQUE                |   1996 | 467574960.675977
 MOZAMBIQUE                |   1995 | 466514395.673452
 MOZAMBIQUE                |   1994 | 463927744.048874
 MOZAMBIQUE                |   1993 |  452923385.62384
 MOZAMBIQUE                |   1992 | 457774450.827666
 PERU                      |   1998 | 266035271.742126
 PERU                      |   1997 | 460434895.584698
 PERU                      |   1996 | 458191319.752985
 PERU                      |   1995 | 460286762.209972
 PERU                      |   1994 | 451274783.865834
 PERU                      |   1993 | 453340585.222243
 PERU                      |   1992 | 461438943.938661
 ROMANIA                   |   1998 | 282170607.802904
 ROMANIA                   |   1997 | 473063127.902941
 ROMANIA                   |   1996 | 475233471.558473
 ROMANIA                   |   1995 | 476395631.642432
 ROMANIA                   |   1994 | 474331411.271264
 ROMANIA                   |   1993 | 475551925.630171
 ROMANIA                   |   1992 | 471587585.714988
 RUSSIA                    |   1998 | 283218777.999119
 RUSSIA                    |   1997 | 480159135.536385
 RUSSIA                    |   1996 | 474954458.734183
 RUSSIA                    |   1995 | 480430740.311884
 RUSSIA                    |   1994 | 479834662.545912
 RUSSIA                    |   1993 | 477681289.576554
 RUSSIA                    |   1992 | 479572444.084354
 SAUDI ARABIA              |   1998 | 273068799.742303
 SAUDI ARABIA              |   1997 | 458006171.754143
 SAUDI ARABIA              |   1996 | 469855560.847603
 SAUDI ARABIA              |   1995 | 469218492.561159
 SAUDI ARABIA              |   1994 | 461639844.644444
 SAUDI ARABIA              |   1993 | 460265951.155077
 SAUDI ARABIA              |   1992 | 459838948.677453
 UNITED KINGDOM            |   1998 | 271871171.199725
 UNITED KINGDOM            |   1997 | 466920372.507017
 UNITED KINGDOM            |   1996 | 461153879.633619
 UNITED KINGDOM            |   1995 | 463348407.406485
 UNITED KINGDOM            |   1994 | 468116636.485775
 UNITED KINGDOM            |   1993 | 469998570.843397
 UNITED KINGDOM            |   1992 |  469794052.92888
 UNITED STATES             |   1998 | 277482277.356761
 UNITED STATES             |   1997 | 474262130.497346
 UNITED STATES             |   1996 | 472622696.333757
 UNITED STATES             |   1995 | 472206188.593559
 UNITED STATES             |   1994 | 481254499.777259
 UNITED STATES             |   1993 | 481005319.355473
 UNITED STATES             |   1992 |  476033606.46028
 VIETNAM                   |   1998 | 274619590.331599
 VIETNAM                   |   1997 |  467697752.50662
 VIETNAM                   |   1996 | 470657176.103213
 VIETNAM                   |   1995 | 467046061.058102
 VIETNAM                   |   1994 | 464890822.537351
 VIETNAM                   |   1993 |  466533547.24961
 VIETNAM                   |   1992 | 461909874.964543
(175 rows)

COMMIT;
COMMIT
