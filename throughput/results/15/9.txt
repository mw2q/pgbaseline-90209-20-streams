BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%burlywood%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264756475.498064
 ALGERIA                   |   1997 | 456527281.067914
 ALGERIA                   |   1996 | 454584626.867866
 ALGERIA                   |   1995 | 463368149.655337
 ALGERIA                   |   1994 | 452698041.526608
 ALGERIA                   |   1993 | 457903393.194142
 ALGERIA                   |   1992 | 455621840.906822
 ARGENTINA                 |   1998 | 268622881.294788
 ARGENTINA                 |   1997 | 462580113.268142
 ARGENTINA                 |   1996 | 462081817.989118
 ARGENTINA                 |   1995 | 469948435.623686
 ARGENTINA                 |   1994 | 463890845.949181
 ARGENTINA                 |   1993 | 467630403.357629
 ARGENTINA                 |   1992 | 457747691.576098
 BRAZIL                    |   1998 |  278325007.27825
 BRAZIL                    |   1997 | 469357939.511054
 BRAZIL                    |   1996 | 467789309.063749
 BRAZIL                    |   1995 | 474424910.080776
 BRAZIL                    |   1994 | 460094115.797868
 BRAZIL                    |   1993 | 471162973.232542
 BRAZIL                    |   1992 | 470346728.790144
 CANADA                    |   1998 | 276238219.694022
 CANADA                    |   1997 | 474846874.945374
 CANADA                    |   1996 | 475401378.566388
 CANADA                    |   1995 | 481690522.073649
 CANADA                    |   1994 | 482510186.716116
 CANADA                    |   1993 | 472243541.858837
 CANADA                    |   1992 | 468519101.218828
 CHINA                     |   1998 |  270180183.30159
 CHINA                     |   1997 | 461115882.098986
 CHINA                     |   1996 | 470638507.424315
 CHINA                     |   1995 |  460041544.56029
 CHINA                     |   1994 | 465439869.323848
 CHINA                     |   1993 | 457449807.853977
 CHINA                     |   1992 | 457312368.314129
 EGYPT                     |   1998 | 265681971.684808
 EGYPT                     |   1997 | 466273581.910185
 EGYPT                     |   1996 | 461165680.631239
 EGYPT                     |   1995 | 452348030.715523
 EGYPT                     |   1994 | 460938911.215536
 EGYPT                     |   1993 | 456730502.350937
 EGYPT                     |   1992 | 460718786.127813
 ETHIOPIA                  |   1998 | 263269586.689956
 ETHIOPIA                  |   1997 | 454760293.584254
 ETHIOPIA                  |   1996 | 460480196.607979
 ETHIOPIA                  |   1995 | 458709778.975104
 ETHIOPIA                  |   1994 | 458280222.870845
 ETHIOPIA                  |   1993 | 462749444.073661
 ETHIOPIA                  |   1992 | 458623716.485316
 FRANCE                    |   1998 |  264800974.33239
 FRANCE                    |   1997 | 454085680.080984
 FRANCE                    |   1996 | 466625504.853033
 FRANCE                    |   1995 | 462064294.665042
 FRANCE                    |   1994 | 455381716.912204
 FRANCE                    |   1993 | 458560563.475102
 FRANCE                    |   1992 | 469978995.218596
 GERMANY                   |   1998 | 282534875.073331
 GERMANY                   |   1997 |  479855986.65129
 GERMANY                   |   1996 |  475032854.79714
 GERMANY                   |   1995 | 468575100.829999
 GERMANY                   |   1994 | 473051604.907796
 GERMANY                   |   1993 | 479488572.863728
 GERMANY                   |   1992 | 478149139.086814
 INDIA                     |   1998 | 277736714.011065
 INDIA                     |   1997 | 472165757.654529
 INDIA                     |   1996 | 478554438.839287
 INDIA                     |   1995 | 469840045.991121
 INDIA                     |   1994 | 476205578.939368
 INDIA                     |   1993 | 474219569.839721
 INDIA                     |   1992 | 470790146.975288
 INDONESIA                 |   1998 | 276133455.464057
 INDONESIA                 |   1997 | 461889926.833396
 INDONESIA                 |   1996 | 463422908.553205
 INDONESIA                 |   1995 | 465150447.087899
 INDONESIA                 |   1994 | 467184412.069535
 INDONESIA                 |   1993 | 460202471.861448
 INDONESIA                 |   1992 | 461123751.874816
 IRAN                      |   1998 | 270285079.318094
 IRAN                      |   1997 | 455668803.997162
 IRAN                      |   1996 | 447904253.678993
 IRAN                      |   1995 | 462808691.878836
 IRAN                      |   1994 |  455833902.25202
 IRAN                      |   1993 | 450922267.575037
 IRAN                      |   1992 |  459382908.71677
 IRAQ                      |   1998 |  274932413.37019
 IRAQ                      |   1997 | 471587584.366216
 IRAQ                      |   1996 |  470373995.78328
 IRAQ                      |   1995 | 471669048.843977
 IRAQ                      |   1994 | 474137349.890496
 IRAQ                      |   1993 | 470386299.000804
 IRAQ                      |   1992 |  471243769.39291
 JAPAN                     |   1998 | 274563612.495551
 JAPAN                     |   1997 | 465973147.083593
 JAPAN                     |   1996 | 471502455.171728
 JAPAN                     |   1995 | 462491155.118144
 JAPAN                     |   1994 | 473136227.355711
 JAPAN                     |   1993 | 468649914.200318
 JAPAN                     |   1992 | 461059803.656924
 JORDAN                    |   1998 | 270422198.474349
 JORDAN                    |   1997 | 459639742.116705
 JORDAN                    |   1996 |  457986527.46929
 JORDAN                    |   1995 | 461531860.590893
 JORDAN                    |   1994 | 458237411.498828
 JORDAN                    |   1993 | 467704555.005339
 JORDAN                    |   1992 | 460665162.075517
 KENYA                     |   1998 |  272656550.29118
 KENYA                     |   1997 | 470607564.227524
 KENYA                     |   1996 | 469516139.912752
 KENYA                     |   1995 | 471021647.587756
 KENYA                     |   1994 | 472702370.437632
 KENYA                     |   1993 | 469602688.582637
 KENYA                     |   1992 | 472162213.038602
 MOROCCO                   |   1998 | 278957618.748874
 MOROCCO                   |   1997 | 474175180.886928
 MOROCCO                   |   1996 | 478365516.841574
 MOROCCO                   |   1995 | 469044812.422567
 MOROCCO                   |   1994 | 474325184.323275
 MOROCCO                   |   1993 | 471928001.086189
 MOROCCO                   |   1992 | 476035269.061203
 MOZAMBIQUE                |   1998 | 276099596.339752
 MOZAMBIQUE                |   1997 | 463954929.454264
 MOZAMBIQUE                |   1996 | 458892443.631124
 MOZAMBIQUE                |   1995 |  464671028.96955
 MOZAMBIQUE                |   1994 | 455534236.308812
 MOZAMBIQUE                |   1993 | 456123916.947408
 MOZAMBIQUE                |   1992 | 461912412.879201
 PERU                      |   1998 | 265184602.152936
 PERU                      |   1997 | 460684260.110556
 PERU                      |   1996 | 464170376.101726
 PERU                      |   1995 | 455038676.189267
 PERU                      |   1994 | 455753144.552658
 PERU                      |   1993 |  449472797.24823
 PERU                      |   1992 |  451529073.84254
 ROMANIA                   |   1998 | 270880735.682613
 ROMANIA                   |   1997 | 463654647.420761
 ROMANIA                   |   1996 | 463432798.025809
 ROMANIA                   |   1995 | 464542182.872177
 ROMANIA                   |   1994 | 470246836.075877
 ROMANIA                   |   1993 | 463095398.736487
 ROMANIA                   |   1992 | 470857371.764301
 RUSSIA                    |   1998 | 274077058.289563
 RUSSIA                    |   1997 | 466461586.545073
 RUSSIA                    |   1996 | 464287652.215813
 RUSSIA                    |   1995 | 471029022.057341
 RUSSIA                    |   1994 | 463894172.738882
 RUSSIA                    |   1993 | 465291741.910888
 RUSSIA                    |   1992 |  468373342.88607
 SAUDI ARABIA              |   1998 | 278284542.002221
 SAUDI ARABIA              |   1997 | 462104836.961629
 SAUDI ARABIA              |   1996 | 460901798.892032
 SAUDI ARABIA              |   1995 | 464277136.882382
 SAUDI ARABIA              |   1994 | 464245724.994325
 SAUDI ARABIA              |   1993 | 461360065.789539
 SAUDI ARABIA              |   1992 | 461377505.619264
 UNITED KINGDOM            |   1998 | 265455002.405961
 UNITED KINGDOM            |   1997 |  456506898.47672
 UNITED KINGDOM            |   1996 |  454268399.58268
 UNITED KINGDOM            |   1995 | 456589946.516945
 UNITED KINGDOM            |   1994 | 449443363.794807
 UNITED KINGDOM            |   1993 | 452720676.591157
 UNITED KINGDOM            |   1992 | 455515796.580472
 UNITED STATES             |   1998 | 278919175.824309
 UNITED STATES             |   1997 |  473093895.92751
 UNITED STATES             |   1996 | 474846038.538573
 UNITED STATES             |   1995 |  473962131.30001
 UNITED STATES             |   1994 | 480275821.006411
 UNITED STATES             |   1993 | 475520185.776948
 UNITED STATES             |   1992 | 474867715.226728
 VIETNAM                   |   1998 | 274821740.907059
 VIETNAM                   |   1997 | 460670526.080543
 VIETNAM                   |   1996 | 470247609.725118
 VIETNAM                   |   1995 | 459874218.179975
 VIETNAM                   |   1994 | 465831999.488792
 VIETNAM                   |   1993 |  465310785.58165
 VIETNAM                   |   1992 | 469199975.163665
(175 rows)

COMMIT;
COMMIT
