BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |   267273688.7831
 ALGERIA                   |   1997 | 455425511.289755
 ALGERIA                   |   1996 | 452969174.001445
 ALGERIA                   |   1995 | 459621364.773241
 ALGERIA                   |   1994 | 451369463.374467
 ALGERIA                   |   1993 | 456660835.040237
 ALGERIA                   |   1992 | 457936480.612815
 ARGENTINA                 |   1998 | 272771135.541423
 ARGENTINA                 |   1997 | 473770090.028457
 ARGENTINA                 |   1996 | 470115804.353529
 ARGENTINA                 |   1995 | 467445297.051584
 ARGENTINA                 |   1994 | 475125392.261981
 ARGENTINA                 |   1993 | 467623978.126109
 ARGENTINA                 |   1992 | 475535948.334493
 BRAZIL                    |   1998 | 275212065.242061
 BRAZIL                    |   1997 |  467395328.39489
 BRAZIL                    |   1996 | 467052505.811666
 BRAZIL                    |   1995 | 466508217.245874
 BRAZIL                    |   1994 |  469386784.06321
 BRAZIL                    |   1993 | 464712766.148396
 BRAZIL                    |   1992 | 478024359.617006
 CANADA                    |   1998 | 281339198.957198
 CANADA                    |   1997 | 481413593.274422
 CANADA                    |   1996 | 477855168.365189
 CANADA                    |   1995 | 476763638.722288
 CANADA                    |   1994 | 485798408.698703
 CANADA                    |   1993 | 479955313.338372
 CANADA                    |   1992 | 477541841.418829
 CHINA                     |   1998 | 274529811.083646
 CHINA                     |   1997 | 468794421.285141
 CHINA                     |   1996 | 472415708.234285
 CHINA                     |   1995 | 456538179.998795
 CHINA                     |   1994 | 468982008.378128
 CHINA                     |   1993 | 475744879.024556
 CHINA                     |   1992 | 469182776.092578
 EGYPT                     |   1998 | 276664292.772551
 EGYPT                     |   1997 | 462077623.144449
 EGYPT                     |   1996 | 466443707.096596
 EGYPT                     |   1995 | 463060420.934219
 EGYPT                     |   1994 | 464263271.623051
 EGYPT                     |   1993 | 459735354.056704
 EGYPT                     |   1992 | 462632671.834158
 ETHIOPIA                  |   1998 | 263577332.686504
 ETHIOPIA                  |   1997 | 451145118.919417
 ETHIOPIA                  |   1996 | 453047298.438547
 ETHIOPIA                  |   1995 | 454258748.062175
 ETHIOPIA                  |   1994 | 459681747.938934
 ETHIOPIA                  |   1993 | 454118165.913197
 ETHIOPIA                  |   1992 |  453271821.07761
 FRANCE                    |   1998 | 269157734.670845
 FRANCE                    |   1997 | 453909726.241593
 FRANCE                    |   1996 | 459688587.226838
 FRANCE                    |   1995 |  466564729.45292
 FRANCE                    |   1994 | 453537719.795815
 FRANCE                    |   1993 | 459904863.346976
 FRANCE                    |   1992 | 459492196.736328
 GERMANY                   |   1998 | 277934956.487363
 GERMANY                   |   1997 | 473777645.332305
 GERMANY                   |   1996 | 472552934.974678
 GERMANY                   |   1995 | 468787605.821628
 GERMANY                   |   1994 | 471471151.611857
 GERMANY                   |   1993 | 473178719.388978
 GERMANY                   |   1992 | 467297986.332772
 INDIA                     |   1998 | 271102815.414412
 INDIA                     |   1997 | 468542102.350817
 INDIA                     |   1996 | 466997907.153999
 INDIA                     |   1995 | 465137296.643199
 INDIA                     |   1994 | 470183179.005329
 INDIA                     |   1993 | 464661273.553354
 INDIA                     |   1992 | 470852041.613906
 INDONESIA                 |   1998 | 268393863.669957
 INDONESIA                 |   1997 | 463392323.345023
 INDONESIA                 |   1996 | 458565460.682362
 INDONESIA                 |   1995 | 458086875.984344
 INDONESIA                 |   1994 | 463502165.742746
 INDONESIA                 |   1993 | 458372120.716592
 INDONESIA                 |   1992 | 459741780.251361
 IRAN                      |   1998 | 268270431.086644
 IRAN                      |   1997 | 446788594.074355
 IRAN                      |   1996 | 460426768.669021
 IRAN                      |   1995 | 454908137.104046
 IRAN                      |   1994 | 459853512.924037
 IRAN                      |   1993 | 453819855.607078
 IRAN                      |   1992 | 455634105.312628
 IRAQ                      |   1998 | 277276049.591129
 IRAQ                      |   1997 | 470481676.404748
 IRAQ                      |   1996 | 473496977.681837
 IRAQ                      |   1995 | 472410423.296463
 IRAQ                      |   1994 | 468884697.690243
 IRAQ                      |   1993 | 469162874.683953
 IRAQ                      |   1992 | 464951723.855047
 JAPAN                     |   1998 | 271180090.602769
 JAPAN                     |   1997 | 466410330.722364
 JAPAN                     |   1996 | 460808202.889108
 JAPAN                     |   1995 |  464231234.69094
 JAPAN                     |   1994 | 469707286.914359
 JAPAN                     |   1993 | 473816460.148681
 JAPAN                     |   1992 |  465794666.21338
 JORDAN                    |   1998 | 271381492.640784
 JORDAN                    |   1997 | 465240181.543195
 JORDAN                    |   1996 | 456791384.785287
 JORDAN                    |   1995 | 459456312.977183
 JORDAN                    |   1994 | 459246455.727833
 JORDAN                    |   1993 |  461712367.72752
 JORDAN                    |   1992 | 463664177.862987
 KENYA                     |   1998 | 272682192.453305
 KENYA                     |   1997 | 461289439.995784
 KENYA                     |   1996 | 467753540.858943
 KENYA                     |   1995 | 459107117.364184
 KENYA                     |   1994 | 460480387.654871
 KENYA                     |   1993 | 466168089.121099
 KENYA                     |   1992 | 463725136.377857
 MOROCCO                   |   1998 | 273164711.116378
 MOROCCO                   |   1997 | 466714726.532033
 MOROCCO                   |   1996 | 472516240.492598
 MOROCCO                   |   1995 | 469602535.592515
 MOROCCO                   |   1994 |  463786868.14848
 MOROCCO                   |   1993 | 468762263.172794
 MOROCCO                   |   1992 | 471373888.924026
 MOZAMBIQUE                |   1998 | 273534351.643862
 MOZAMBIQUE                |   1997 | 455620909.514718
 MOZAMBIQUE                |   1996 | 464550691.616376
 MOZAMBIQUE                |   1995 | 460497167.189319
 MOZAMBIQUE                |   1994 | 458593985.429772
 MOZAMBIQUE                |   1993 | 453958999.628822
 MOZAMBIQUE                |   1992 | 461453226.155665
 PERU                      |   1998 | 268550009.450811
 PERU                      |   1997 | 474507565.772927
 PERU                      |   1996 | 470105932.091058
 PERU                      |   1995 | 458220882.121167
 PERU                      |   1994 | 467510010.047196
 PERU                      |   1993 |  467436132.75059
 PERU                      |   1992 | 476922358.894159
 ROMANIA                   |   1998 | 271747854.948091
 ROMANIA                   |   1997 | 458951341.049936
 ROMANIA                   |   1996 | 466215034.794208
 ROMANIA                   |   1995 | 462316405.882682
 ROMANIA                   |   1994 | 457138732.407556
 ROMANIA                   |   1993 | 457745397.168986
 ROMANIA                   |   1992 | 460771743.384959
 RUSSIA                    |   1998 |  281012234.39463
 RUSSIA                    |   1997 | 467926217.832496
 RUSSIA                    |   1996 | 480107604.278598
 RUSSIA                    |   1995 | 471526791.097894
 RUSSIA                    |   1994 | 471632179.294613
 RUSSIA                    |   1993 | 466935371.531789
 RUSSIA                    |   1992 | 464709615.152691
 SAUDI ARABIA              |   1998 | 279513636.266707
 SAUDI ARABIA              |   1997 | 465003837.948351
 SAUDI ARABIA              |   1996 | 477368295.125232
 SAUDI ARABIA              |   1995 |  465822952.81568
 SAUDI ARABIA              |   1994 | 466321112.858209
 SAUDI ARABIA              |   1993 | 468782903.614683
 SAUDI ARABIA              |   1992 | 473048156.256646
 UNITED KINGDOM            |   1998 | 271206971.039841
 UNITED KINGDOM            |   1997 | 455561901.872871
 UNITED KINGDOM            |   1996 | 454202398.703368
 UNITED KINGDOM            |   1995 | 454609307.468621
 UNITED KINGDOM            |   1994 | 460671392.535692
 UNITED KINGDOM            |   1993 | 458040873.869254
 UNITED KINGDOM            |   1992 | 450832430.171972
 UNITED STATES             |   1998 | 274897376.144709
 UNITED STATES             |   1997 | 469225306.279196
 UNITED STATES             |   1996 | 462556165.305506
 UNITED STATES             |   1995 | 465197034.985925
 UNITED STATES             |   1994 | 472502206.252033
 UNITED STATES             |   1993 | 463133335.217057
 UNITED STATES             |   1992 | 467364138.655034
 VIETNAM                   |   1998 |  270820156.02521
 VIETNAM                   |   1997 | 457806266.267278
 VIETNAM                   |   1996 | 465488547.656259
 VIETNAM                   |   1995 | 462575315.494311
 VIETNAM                   |   1994 | 468572171.894213
 VIETNAM                   |   1993 | 466571499.718529
 VIETNAM                   |   1992 | 463206458.569312
(175 rows)

COMMIT;
COMMIT
