BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%saddle%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264692351.113293
 ALGERIA                   |   1997 | 457858799.838284
 ALGERIA                   |   1996 | 464384287.764763
 ALGERIA                   |   1995 | 464076937.772115
 ALGERIA                   |   1994 | 466998144.767573
 ALGERIA                   |   1993 | 462848168.035732
 ALGERIA                   |   1992 | 462484291.898411
 ARGENTINA                 |   1998 | 278679203.936156
 ARGENTINA                 |   1997 | 469613751.634434
 ARGENTINA                 |   1996 | 466677900.348617
 ARGENTINA                 |   1995 | 468065503.753543
 ARGENTINA                 |   1994 | 471807114.076129
 ARGENTINA                 |   1993 |  468319594.37942
 ARGENTINA                 |   1992 | 463002873.788843
 BRAZIL                    |   1998 | 277572170.192901
 BRAZIL                    |   1997 | 472624555.176578
 BRAZIL                    |   1996 | 472542295.997892
 BRAZIL                    |   1995 | 467687018.127019
 BRAZIL                    |   1994 | 465750828.256852
 BRAZIL                    |   1993 | 469747374.388813
 BRAZIL                    |   1992 | 468889524.878942
 CANADA                    |   1998 | 272264559.892707
 CANADA                    |   1997 | 474588192.228229
 CANADA                    |   1996 |  474977526.07771
 CANADA                    |   1995 | 480997587.144042
 CANADA                    |   1994 | 475431439.674573
 CANADA                    |   1993 | 485625955.920733
 CANADA                    |   1992 | 479467969.725383
 CHINA                     |   1998 | 274060509.135403
 CHINA                     |   1997 | 466139136.953968
 CHINA                     |   1996 | 461929490.823204
 CHINA                     |   1995 | 469186761.518526
 CHINA                     |   1994 |  465686294.54063
 CHINA                     |   1993 | 464721563.265786
 CHINA                     |   1992 | 468469990.141244
 EGYPT                     |   1998 | 267928438.198388
 EGYPT                     |   1997 |  455662967.08987
 EGYPT                     |   1996 | 458430595.418008
 EGYPT                     |   1995 | 459057835.893609
 EGYPT                     |   1994 | 454065873.930849
 EGYPT                     |   1993 |   466885187.7625
 EGYPT                     |   1992 | 447218605.649897
 ETHIOPIA                  |   1998 | 271153661.185196
 ETHIOPIA                  |   1997 | 466720227.004915
 ETHIOPIA                  |   1996 | 463597613.495562
 ETHIOPIA                  |   1995 | 457364137.283524
 ETHIOPIA                  |   1994 |  464464095.77965
 ETHIOPIA                  |   1993 | 462684764.915798
 ETHIOPIA                  |   1992 | 469372915.691461
 FRANCE                    |   1998 | 267282164.222409
 FRANCE                    |   1997 | 456072248.079885
 FRANCE                    |   1996 | 455980860.537329
 FRANCE                    |   1995 | 461303526.106245
 FRANCE                    |   1994 | 468857453.600498
 FRANCE                    |   1993 | 461484963.756481
 FRANCE                    |   1992 | 462361132.738158
 GERMANY                   |   1998 | 277423945.224006
 GERMANY                   |   1997 |  480433942.06014
 GERMANY                   |   1996 | 480881672.544299
 GERMANY                   |   1995 |  479591068.45815
 GERMANY                   |   1994 | 479284110.909814
 GERMANY                   |   1993 | 483364469.447506
 GERMANY                   |   1992 | 480262208.041531
 INDIA                     |   1998 | 275746708.048419
 INDIA                     |   1997 | 475737725.775572
 INDIA                     |   1996 | 473864593.094881
 INDIA                     |   1995 | 480754570.875106
 INDIA                     |   1994 | 487185670.183021
 INDIA                     |   1993 | 473104501.060613
 INDIA                     |   1992 | 477176804.986925
 INDONESIA                 |   1998 | 269889753.353928
 INDONESIA                 |   1997 | 465613724.776211
 INDONESIA                 |   1996 | 470721511.979421
 INDONESIA                 |   1995 | 466813091.897211
 INDONESIA                 |   1994 | 472765405.405493
 INDONESIA                 |   1993 | 466302932.256748
 INDONESIA                 |   1992 |  469504266.02909
 IRAN                      |   1998 | 264478181.694231
 IRAN                      |   1997 | 455589791.257868
 IRAN                      |   1996 | 458556118.157015
 IRAN                      |   1995 | 459522456.948567
 IRAN                      |   1994 | 451371283.481657
 IRAN                      |   1993 | 453458761.699643
 IRAN                      |   1992 | 460133421.533634
 IRAQ                      |   1998 | 280667429.775039
 IRAQ                      |   1997 | 467568880.704738
 IRAQ                      |   1996 | 470767351.613248
 IRAQ                      |   1995 | 467088014.672251
 IRAQ                      |   1994 | 477071856.571284
 IRAQ                      |   1993 | 472457633.372572
 IRAQ                      |   1992 | 477793035.884351
 JAPAN                     |   1998 |  264981629.42213
 JAPAN                     |   1997 | 465008855.371087
 JAPAN                     |   1996 |   463172364.6898
 JAPAN                     |   1995 | 459334795.338283
 JAPAN                     |   1994 | 462248311.251736
 JAPAN                     |   1993 | 465235973.932735
 JAPAN                     |   1992 | 465668779.929821
 JORDAN                    |   1998 | 273020062.459142
 JORDAN                    |   1997 | 460043183.096654
 JORDAN                    |   1996 | 466456631.139532
 JORDAN                    |   1995 |   460970588.1453
 JORDAN                    |   1994 | 466627694.187153
 JORDAN                    |   1993 | 461904889.136507
 JORDAN                    |   1992 | 459732185.024596
 KENYA                     |   1998 | 267802787.063457
 KENYA                     |   1997 | 462833864.281552
 KENYA                     |   1996 | 469169549.446405
 KENYA                     |   1995 | 470847562.742076
 KENYA                     |   1994 | 462392647.111536
 KENYA                     |   1993 | 469390572.473454
 KENYA                     |   1992 | 473618788.283279
 MOROCCO                   |   1998 | 272007252.976687
 MOROCCO                   |   1997 | 471336531.655492
 MOROCCO                   |   1996 | 466453380.129324
 MOROCCO                   |   1995 |  470463671.74645
 MOROCCO                   |   1994 | 466484443.334813
 MOROCCO                   |   1993 | 471159185.778681
 MOROCCO                   |   1992 | 478178775.649794
 MOZAMBIQUE                |   1998 | 272430521.909869
 MOZAMBIQUE                |   1997 | 462889134.792652
 MOZAMBIQUE                |   1996 | 468664464.737373
 MOZAMBIQUE                |   1995 | 458297215.830386
 MOZAMBIQUE                |   1994 | 463624537.387377
 MOZAMBIQUE                |   1993 | 456707720.603562
 MOZAMBIQUE                |   1992 | 454185105.190512
 PERU                      |   1998 | 278124761.478461
 PERU                      |   1997 | 469617977.505345
 PERU                      |   1996 |  469201999.22383
 PERU                      |   1995 | 467700737.927121
 PERU                      |   1994 | 463107164.433998
 PERU                      |   1993 | 467174238.711595
 PERU                      |   1992 | 463895396.857016
 ROMANIA                   |   1998 | 272258084.860715
 ROMANIA                   |   1997 | 463104307.355859
 ROMANIA                   |   1996 | 471534511.150025
 ROMANIA                   |   1995 | 466122916.941273
 ROMANIA                   |   1994 | 461817934.165035
 ROMANIA                   |   1993 | 458840150.629207
 ROMANIA                   |   1992 | 467179583.929877
 RUSSIA                    |   1998 | 277305086.123062
 RUSSIA                    |   1997 | 474915589.497242
 RUSSIA                    |   1996 | 481859076.136426
 RUSSIA                    |   1995 | 467698105.606139
 RUSSIA                    |   1994 | 476121704.707208
 RUSSIA                    |   1993 | 474736704.092473
 RUSSIA                    |   1992 | 467093063.068595
 SAUDI ARABIA              |   1998 |  278436993.45465
 SAUDI ARABIA              |   1997 | 472774825.738938
 SAUDI ARABIA              |   1996 | 481251593.491566
 SAUDI ARABIA              |   1995 |  473737388.19368
 SAUDI ARABIA              |   1994 | 473642616.698488
 SAUDI ARABIA              |   1993 | 473207787.652078
 SAUDI ARABIA              |   1992 | 474408321.200866
 UNITED KINGDOM            |   1998 | 270484037.502872
 UNITED KINGDOM            |   1997 | 461300329.004997
 UNITED KINGDOM            |   1996 | 470082044.639931
 UNITED KINGDOM            |   1995 | 472235940.071933
 UNITED KINGDOM            |   1994 |  470413632.47525
 UNITED KINGDOM            |   1993 | 470952904.319228
 UNITED KINGDOM            |   1992 | 468854265.377719
 UNITED STATES             |   1998 | 277089518.618109
 UNITED STATES             |   1997 |  472861569.45288
 UNITED STATES             |   1996 | 477352252.533334
 UNITED STATES             |   1995 | 476414571.242616
 UNITED STATES             |   1994 | 484129572.927518
 UNITED STATES             |   1993 | 474371097.437727
 UNITED STATES             |   1992 | 474187439.180681
 VIETNAM                   |   1998 | 276304137.180165
 VIETNAM                   |   1997 | 468349419.994378
 VIETNAM                   |   1996 | 470376082.557367
 VIETNAM                   |   1995 |  467933259.03139
 VIETNAM                   |   1994 | 464080245.150246
 VIETNAM                   |   1993 | 473154303.550717
 VIETNAM                   |   1992 |  470169768.79919
(175 rows)

COMMIT;
COMMIT
